var _0x2bba=['Q09ORklHIUQzMA==','Q09ORklHIUQzMQ==','Q09ORklHIUQzMjpEMzM=','c2V0TnVtYmVyRm9ybWF0','IVI2OlI=','eXl5eS1tbS1kZCBoaDptbTpzcw==','Q1NWIEltcG9ydA==','UHJvY2VzcyBGaW5pc2hlZA==','RGVidWcgbW9kZSBjYW4gYmUgdHVybmVkIG9uL29mZiBpbiBDT05GSUchRDI1','ZGF0YQ==','bW9kZQ==','ZXZhbHVhdGlvbg==','ZGxlZnQ=','dG9TdHJpbmc=','IGRheXMgbGVmdA==','ZXhwaXJlZA==','MTQgZGF5IGV2YWx1YXRpb24gaGFzIGV4cGlyZWQuIFN0YXJ0ZWQgb24g','ZGF0ZV9zdGFydF9ldmE=','bGljZW5zZWQ=','bWVzc2FnZQ==','Q09ORklHISRKJDI5','Y2hhckF0','dG9VcHBlckNhc2U=','c2xpY2U=','Q09ORklHISREJDEw','U2tpcHBlZCB1cGRhdGluZyBjZWxscyAjMjEz','X0dldEJhbGFuY2Vz','QmFsYW5jZQ==','RW1wdHkgcmVzcG9uc2UgZnJvbSB5b3VyIGV4Y2hhbmdl','YmFsYW5jZQ==','Kioq','cHVzaA==','Y3VyY29kZUVY','c29ydA==','Q3JlYXRlQmFsYW5jZXMgT3V0cHV0','Z2V0QWN0aXZlU3ByZWFkc2hlZXQ=','Z2V0U2hlZXRCeU5hbWU=','Z2V0UmFuZ2U=','Z2V0TGFzdFJvdw==','Z2V0VmFsdWVz','Zm9yY2VzeW1ib2w=','c3BsaXQ=','aW5kZXhPZg==','ZXhjaGFuZ2U=','Q3JlYXRlT3JkZXJIaXN0b3J5LCBCYWxhbmNlIERlbHRhcyArIEZvcmNlIFN5bWJvbCBpcyA6','c3ltYm9scw==','X0dldG9yZGVyaGlzdG9yeQ==','KHNldHRpbmdzKQ==','X0ltcG9ydA==','aXNEYXRl','ZGF0ZQ==','bXNnQm94','IENyZWF0ZU9yZGVySGlzdG9yeTogQSBkYXRlIGZpZWxkIHdhcyBleHBlY3RlZCBidXQgSSByZWNlaXZlZCBhIHN0cmluZw==','bGVuZ3Ro','YWRqdXN0aG91cg==','UGx1cyAxaA==','c2V0SG91cnM=','Z2V0SG91cnM=','Y3Vy','bmN1cg==','bmFtZQ==','bm1hcmtldA==','dG90YWw=','cXVhbnRpdHk=','dG9maWF0','bWFya2V0','ZmVlY3Vy','bmZlZWN1cg==','ZmVlZmlhdA==','ZmVl','b3JkZXJucg==','dW5pdHByaWNl','ZGl2','c3BsaWNl','bG9n','TmVzdGVkIG9yZGVycyA9PiA=','dHlwZQ==','Q3JlYXRlT3JkZXJIaXN0b3J5IE91dHB1dA==','YWxsb3dzbWFsbGRldmlhdGlvbnM=','QnV5','c3VwcHJlc3Nsb3Nz','c2V0VmFsdWVz','TzJPTWF0Y2g=','bWF0Y2hyYW5nZXNlbGxvcmRlcnM=','T0ZG','U2VsbA==','bWF0Y2hyYW5nZWJ1eW9yZGVycw==','Q291bnRlck1hdGNo','WUVT','c2V0VmFsdWU=','VW5tYXRjaGVk','Y2xlYXJDb250ZW50','Ymlk','WVlZWU1NREQ=','ZnJvbU5vdw==','X0dldGRlcG9zaXRoaXN0b3J5','UGVyaW9kaWNhbGx5','Q09ORklHIWQ4OmY4','bWVyZ2U=','ZW5jb2Rl','Q09ORklHIWQ5OmY5','Q09ORklHIWQ4OmY5','c2V0Qm9yZGVy','Qm9yZGVyU3R5bGU=','U09MSUQ=','c2V0QmFja2dyb3VuZA==','I2ZmZjJlZA==','c2V0Rm9udENvbG9y','IzQzNDM0Mw==','c2V0Rm9udEZhbWlseQ==','c2V0Rm9udFNpemU=','c2V0Rm9udFN0eWxl','bm9ybWFs','c2V0SG9yaXpvbnRhbEFsaWdubWVudA==','bGVmdA==','c2V0VmVydGljYWxBbGlnbm1lbnQ=','bWlkZGxl','cmVtb3Zl','bmV3VHJpZ2dlcg==','Qm90TW9uMA==','b25PcGVu','Y3JlYXRl','Z2V0UHJvamVjdFRyaWdnZXJz','Z2V0SGFuZGxlckZ1bmN0aW9u','ZGVsZXRlVHJpZ2dlcg==','Qm90TW9uMQ==','Qm90TW9uMw==','Z2V0QWN0aXZl','Q09ORklHIUs4OksxMA==','UHJvZmlsZTE=','Zm9yU3ByZWFkc2hlZXQ=','RVZFUlkgNSBNSU4=','Qm90TW9uMg==','dGltZUJhc2Vk','ZXZlcnlNaW51dGVz','RVZFUlkgMTAgTUlO','RVZFUlkgMzAgTUlO','RVZFUlkgSE9VUg==','ZXZlcnlIb3Vycw==','TklHSFRMWSBBVCAzIEFN','YXRIb3Vy','ZXZlcnlEYXlz','RVZFUlkgMyBIT1VSUw==','RVZFUlkgNiBIT1VSUw==','SU5GT1xuXG5UcmlnZ2VycyBhcmUgbm93IA==','Z2V0TWF4Um93cw==','ZGVsZXRlUm93cw==','WW91ciBldmFsdWF0aW9uIHBlcmlvZCBoYXMgZXhwaXJlZA==','V0FSTklOR1xuXG5UaGlzIHdpbGwgZGVsZXRlIGFsbCBkYXRhIGluIHlvdXIgc2hlZXQgYW5kIHJlbW92ZSBUcmlnZ2VycyBmcm9tIHRoaXMgc2hlZXQhXG5cbkFyZSB5b3Ugc3VyZT8=','QnV0dG9ucw==','WUVTX05P','V2l0aGRyYXdhbHM=','TWFya2V0cw==','Q09ORklHIUQ2','QmluYW5jZQ==','Q09ORklHIUQ4OkQ5','Q09ORklHIUQxMQ==','RVVS','Q09ORklHIUQxNA==','Q09ORklHIUQxNg==','Q09ORklHIUQyMDpEMjI=','Q09ORklHIUQyMw==','Q09ORklHIUQyNDpEMjc=','UHJvZmlsZTI='];(function(_0x46e261,_0x46682c){var _0x3405a2=function(_0x58f54b){while(--_0x58f54b){_0x46e261['push'](_0x46e261['shift']());}};_0x3405a2(++_0x46682c);}(_0x2bba,0xbe));var _0x41ca=function(_0x42d95c,_0x3a6d02){_0x42d95c=_0x42d95c-0x0;var _0x2f714e=_0x2bba[_0x42d95c];if(_0x41ca['PeXQua']===undefined){(function(){var _0x1fcf24=function(){var _0x44265e;try{_0x44265e=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x191c79){_0x44265e=window;}return _0x44265e;};var _0x175c6a=_0x1fcf24();var _0x47b732='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x175c6a['atob']||(_0x175c6a['atob']=function(_0xe5a4dd){var _0x2f96b4=String(_0xe5a4dd)['replace'](/=+$/,'');for(var _0xdfa3a5=0x0,_0x12cf09,_0x369db0,_0x3faf86=0x0,_0x3975bd='';_0x369db0=_0x2f96b4['charAt'](_0x3faf86++);~_0x369db0&&(_0x12cf09=_0xdfa3a5%0x4?_0x12cf09*0x40+_0x369db0:_0x369db0,_0xdfa3a5++%0x4)?_0x3975bd+=String['fromCharCode'](0xff&_0x12cf09>>(-0x2*_0xdfa3a5&0x6)):0x0){_0x369db0=_0x47b732['indexOf'](_0x369db0);}return _0x3975bd;});}());_0x41ca['Yyugzb']=function(_0x2db6f3){var _0x1e894f=atob(_0x2db6f3);var _0x1402ee=[];for(var _0x310201=0x0,_0x3b997d=_0x1e894f['length'];_0x310201<_0x3b997d;_0x310201++){_0x1402ee+='%'+('00'+_0x1e894f['charCodeAt'](_0x310201)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x1402ee);};_0x41ca['JAtLvZ']={};_0x41ca['PeXQua']=!![];}var _0x2f5d46=_0x41ca['JAtLvZ'][_0x42d95c];if(_0x2f5d46===undefined){_0x2f714e=_0x41ca['Yyugzb'](_0x2f714e);_0x41ca['JAtLvZ'][_0x42d95c]=_0x2f714e;}else{_0x2f714e=_0x2f5d46;}return _0x2f714e;};function CreateBalances(_0x51365e){var _0x1ba38a=_0x51365e['exchange'];var _0x333950=eval(_0x1ba38a+_0x41ca('0x0')+'()');var _0x446194=0x0;if(DEBUG=='ON'){_0x446194=-0x1;}if(_0x333950==null){DebugLog(_0x41ca('0x1'),_0x41ca('0x2'));return 0x1;}var _0x3df352=[];for(var _0x37e714 in _0x333950){var _0x2f8068=Number(_0x333950[_0x37e714][_0x41ca('0x3')])*0xf4240;if(_0x2f8068>_0x446194&&NormalizeCoinCode(_0x1ba38a,_0x333950[_0x37e714]['curcodeEX'])!=_0x41ca('0x4')){_0x3df352[_0x41ca('0x5')]([CMC_name(NormalizeCoinCode(_0x1ba38a,_0x333950[_0x37e714][_0x41ca('0x6')])),NormalizeCoinCode(_0x1ba38a,_0x333950[_0x37e714][_0x41ca('0x6')]),_0x333950[_0x37e714][_0x41ca('0x3')],ToFiat(NormalizeCoinCode(_0x1ba38a,_0x333950[_0x37e714][_0x41ca('0x6')]),_0x333950[_0x37e714][_0x41ca('0x3')]),CMC_price(NormalizeCoinCode(_0x1ba38a,_0x333950[_0x37e714]['curcodeEX']),'btc')*_0x333950[_0x37e714][_0x41ca('0x3')]]);}}_0x3df352[_0x41ca('0x7')](function(_0x4376bb,_0x35ce2d){return _0x35ce2d[0x3]-_0x4376bb[0x3];});_0x51365e['symbols']=CheckBalanceChange(_0x51365e,_0x3df352);DebugLog(_0x41ca('0x8'),_0x3df352);return _0x3df352;}function CheckBalanceChange(_0x4aa987,_0x5b5396){var _0x2b36cf=SpreadsheetApp[_0x41ca('0x9')]();var _0x560311=_0x2b36cf[_0x41ca('0xa')](_0x41ca('0x1'));var _0x1a0f9a=_0x560311[_0x41ca('0xb')](SHEETROW,SHEETCOL,_0x560311[_0x41ca('0xc')](),0x4)[_0x41ca('0xd')]();var _0x51c84d=![];if(_0x4aa987[_0x41ca('0xe')]!=undefined&&_0x4aa987['forcesymbol']!=''){var _0x294d1a=_0x4aa987[_0x41ca('0xe')][_0x41ca('0xf')](',');}else{var _0x294d1a=[];}for(var _0x397052 in _0x5b5396){for(var _0x8aa96b in _0x1a0f9a){_0x51c84d=![];if(_0x1a0f9a[_0x8aa96b][0x1]==''){break;}if(_0x1a0f9a[_0x8aa96b][0x1]==_0x5b5396[_0x397052][0x1]&&_0x1a0f9a[_0x8aa96b][0x2]==_0x5b5396[_0x397052][0x2]){_0x51c84d=!![];break;}}if(_0x51c84d==![]){{_0x294d1a[_0x41ca('0x5')](UnNormalizeCoinCode(EXCHANGE,_0x5b5396[_0x397052][0x1]));}};}for(var _0x8aa96b in _0x1a0f9a){for(var _0x397052 in _0x5b5396){_0x51c84d=![];if(_0x1a0f9a[_0x8aa96b][0x1]==''){break;}if(_0x1a0f9a[_0x8aa96b][0x1]==_0x5b5396[_0x397052][0x1]&&_0x1a0f9a[_0x8aa96b][0x2]==_0x5b5396[_0x397052][0x2]){_0x51c84d=!![];break;}}if(_0x51c84d==![]){if(_0x1a0f9a[_0x8aa96b][0x1]!=''){if(_0x294d1a[_0x41ca('0x10')](_0x1a0f9a[_0x8aa96b][0x1])<0x0){_0x294d1a[_0x41ca('0x5')](UnNormalizeCoinCode(EXCHANGE,_0x1a0f9a[_0x8aa96b][0x1]));}}}}if(_0x294d1a==''){return null;}return _0x294d1a;}function CreateOrderHistory(_0x472edc,_0x5a2072){var _0x243c20=_0x472edc[_0x41ca('0x11')];DebugLog(_0x41ca('0x12'),_0x472edc[_0x41ca('0x13')]);if(_0x5a2072!='CSV\x20Import')var _0x4c9d79=eval(_0x243c20+_0x41ca('0x14')+_0x41ca('0x15'));else{var _0x4c9d79=eval(_0x243c20+_0x41ca('0x16')+_0x41ca('0x15'));}if(_0x4c9d79==null||_0x4c9d79=='')return 0x1;var _0x2e9ebe=[];if(moment[_0x41ca('0x17')](_0x4c9d79[0x0][_0x41ca('0x18')])==![]){Browser[_0x41ca('0x19')](_0x243c20+_0x41ca('0x1a'));return 0x0;}for(var _0x3c2c4f=0x0;_0x3c2c4f<_0x4c9d79[_0x41ca('0x1b')];_0x3c2c4f++){if(_0x472edc[_0x41ca('0x1c')]==_0x41ca('0x1d')){_0x4c9d79[_0x3c2c4f][_0x41ca('0x18')]=new Date(new Date(_0x4c9d79[_0x3c2c4f]['date'])[_0x41ca('0x1e')](new Date(_0x4c9d79[_0x3c2c4f][_0x41ca('0x18')])[_0x41ca('0x1f')]()+0x1));}if(_0x472edc['adjusthour']=='Min\x201h'){_0x4c9d79[_0x3c2c4f][_0x41ca('0x18')]=new Date(new Date(_0x4c9d79[_0x3c2c4f][_0x41ca('0x18')])[_0x41ca('0x1e')](new Date(_0x4c9d79[_0x3c2c4f][_0x41ca('0x18')])['getHours']()-0x1));}_0x4c9d79[_0x3c2c4f][_0x41ca('0x20')]=function(){return NormalizeCoinCode(_0x243c20,_0x4c9d79[_0x3c2c4f][_0x41ca('0x21')]);};_0x4c9d79[_0x3c2c4f][_0x41ca('0x22')]=function(){return CMC_name(NormalizeCoinCode(_0x243c20,_0x4c9d79[_0x3c2c4f][_0x41ca('0x20')]()));};_0x4c9d79[_0x3c2c4f]['market']=function(){return NormalizeCoinCode(_0x243c20,_0x4c9d79[_0x3c2c4f][_0x41ca('0x23')]);};_0x4c9d79[_0x3c2c4f][_0x41ca('0x24')]=function(){return Number(_0x4c9d79[_0x3c2c4f][_0x41ca('0x25')])*Number(_0x4c9d79[_0x3c2c4f]['unitprice']);};_0x4c9d79[_0x3c2c4f][_0x41ca('0x26')]=function(){return Number(ToFiat(_0x4c9d79[_0x3c2c4f][_0x41ca('0x27')](),_0x4c9d79[_0x3c2c4f][_0x41ca('0x24')]()));};_0x4c9d79[_0x3c2c4f][_0x41ca('0x28')]=function(){return NormalizeCoinCode(_0x243c20,_0x4c9d79[_0x3c2c4f][_0x41ca('0x29')]);};_0x4c9d79[_0x3c2c4f][_0x41ca('0x2a')]=function(){return Number(ToFiat(_0x4c9d79[_0x3c2c4f][_0x41ca('0x28')](),Number(_0x4c9d79[_0x3c2c4f][_0x41ca('0x2b')])));};}for(var _0x3c2c4f=0x0;_0x3c2c4f<_0x4c9d79[_0x41ca('0x1b')];_0x3c2c4f++){try{if(_0x4c9d79[_0x3c2c4f][_0x41ca('0x2c')]!=''){var _0x3b456c=!![];if(_0x3c2c4f<_0x4c9d79[_0x41ca('0x1b')]-0x1){if(_0x4c9d79[_0x3c2c4f][_0x41ca('0x2c')]==_0x4c9d79[_0x3c2c4f+0x1][_0x41ca('0x2c')]){do{var _0x5df8af=[];if(_0x3c2c4f==_0x4c9d79[_0x41ca('0x1b')]){break;}_0x4c9d79[_0x3c2c4f]['quantity']=_0x4c9d79[_0x3c2c4f][_0x41ca('0x25')]+_0x4c9d79[_0x3c2c4f+0x1][_0x41ca('0x25')];_0x4c9d79[_0x3c2c4f]['unitprice']=(_0x4c9d79[_0x3c2c4f]['unitprice']+_0x4c9d79[_0x3c2c4f+0x1][_0x41ca('0x2d')])/0x2;if(_0x4c9d79[_0x3c2c4f][_0x41ca('0x28')]()!=_0x4c9d79[_0x3c2c4f+0x1]['feecur']()){_0x5df8af=_0x4c9d79[_0x3c2c4f]['feefiat']+_0x4c9d79[_0x3c2c4f+0x1][_0x41ca('0x2a')];_0x4c9d79[_0x3c2c4f][_0x41ca('0x2a')]=_0x5df8af;_0x4c9d79[_0x3c2c4f][_0x41ca('0x28')]=_0x41ca('0x2e');}if(_0x3c2c4f<_0x4c9d79[_0x41ca('0x1b')]-0x1){_0x4c9d79[_0x41ca('0x2f')](_0x3c2c4f+0x1,0x1);}if(_0x3c2c4f==_0x4c9d79[_0x41ca('0x1b')]){break;}}while(_0x4c9d79[_0x3c2c4f][_0x41ca('0x2c')]==_0x4c9d79[_0x3c2c4f+0x1][_0x41ca('0x2c')]);}}}}catch(_0x54f3ae){if(DEBUG=='ON'){Logger[_0x41ca('0x30')](_0x41ca('0x31')+_0x54f3ae);}}_0x2e9ebe[_0x41ca('0x5')]([_0x4c9d79[_0x3c2c4f]['date'],_0x4c9d79[_0x3c2c4f][_0x41ca('0x32')],_0x4c9d79[_0x3c2c4f][_0x41ca('0x20')](),_0x4c9d79[_0x3c2c4f][_0x41ca('0x22')](),_0x4c9d79[_0x3c2c4f][_0x41ca('0x27')](),_0x243c20,Number(_0x4c9d79[_0x3c2c4f][_0x41ca('0x25')]),Number(_0x4c9d79[_0x3c2c4f][_0x41ca('0x2d')]),_0x4c9d79[_0x3c2c4f][_0x41ca('0x24')](),_0x4c9d79[_0x3c2c4f][_0x41ca('0x26')](),Number(_0x4c9d79[_0x3c2c4f][_0x41ca('0x2b')]),_0x4c9d79[_0x3c2c4f][_0x41ca('0x28')](),_0x4c9d79[_0x3c2c4f][_0x41ca('0x2a')]()]);}_0x2e9ebe['sort'](function(_0x5c97bf,_0x11e0ae){return _0x11e0ae[0x0]-_0x5c97bf[0x0];});DebugLog(_0x41ca('0x33'),_0x2e9ebe);return _0x2e9ebe;}function OnetoOneMatch(_0x31999a){function _0x4ea240(_0x1aac4a,_0x3fa12c){var _0x4a667b=_0x3fa12c[0xd];var _0x5afa90=_0x1aac4a[0x2];var _0x266e34=_0x3fa12c[0x2];var _0x258d39=_0x3fa12c[0x1];var _0x15461b=_0x1aac4a[0x6];var _0x4d806d=_0x3fa12c[0x6];var _0x4b1e9f=_0x1aac4a[0x9];var _0x2c38fa=_0x3fa12c[0x9];var _0x42d9cc=_0x1aac4a[0xc];var _0x21ffc6=_0x3fa12c[0xc];var _0x2639df=_0x3fa12c[0x0];var _0xdfd06=_0x1aac4a[0x0];var _0x423c27=![];if(_0x4a667b==''){if(_0x258d39=='Buy'&&_0x266e34==_0x5afa90&&_0x4d806d==_0x15461b){_0x423c27=!![];}if(_0x31999a[_0x41ca('0x34')]=='ON'){if(_0x258d39==_0x41ca('0x35')&&_0x266e34==_0x5afa90&&_0x4d806d/_0x15461b<1.01&&_0x4d806d/_0x15461b>0.99){Logger[_0x41ca('0x30')](_0x4d806d/_0x15461b);_0x423c27=!![];}}if(_0x423c27==!![]){_0x2d04fa=[];var _0x22d2d3=((_0x4b1e9f-_0x42d9cc)/_0x15461b-(_0x2c38fa+_0x21ffc6)/_0x4d806d)*_0x15461b;var _0x1e0c47=((_0x4b1e9f-_0x42d9cc)/_0x15461b-(_0x2c38fa+_0x21ffc6)/_0x4d806d)/((_0x2c38fa+_0x21ffc6)/_0x4d806d);if(_0x31999a[_0x41ca('0x36')]=='ON'){if(_0x22d2d3<0x0){_0x22d2d3='';_0x1e0c47='';}}_0x2d04fa[_0x41ca('0x5')](['>','',_0x2639df,_0x22d2d3,_0x1e0c47]);range=_0x2c5e2d[_0x41ca('0xb')](0x6+_0xcb0fd6,0x10,0x1,0x5);range[_0x41ca('0x37')](_0x2d04fa);_0x2d04fa=[];_0x2d04fa[_0x41ca('0x5')](['<','',_0xdfd06,'','']);_0x4a667b='<';range=_0x2c5e2d[_0x41ca('0xb')](0x6+_0x51bc31,0x10,0x1,0x5);range['setValues'](_0x2d04fa);return!![];}}}DebugLog(_0x41ca('0x38'),'');var _0x2c5e2d=SpreadsheetApp[_0x41ca('0x9')]()['getSheetByName'](ORDERHISTORYTAB);var _0x38c290=_0x2c5e2d[_0x41ca('0xb')](SHEETROW,SHEETCOL,_0x2c5e2d[_0x41ca('0xc')](),0x10)[_0x41ca('0xd')]();var _0x2d04fa=[];for(var _0xcb0fd6=0x0;_0xcb0fd6<_0x38c290[_0x41ca('0x1b')];_0xcb0fd6++){var _0x5bc797=_0x38c290[_0xcb0fd6];if(_0x5bc797[0x0]<_0x31999a['matchrangesellorders']&&_0x31999a[_0x41ca('0x39')]!=_0x41ca('0x3a')){break;}var _0x4ab935=_0x5bc797[0x1]['trim']();var _0x3303ee=_0x5bc797[0xd];if(_0x3303ee==_0x41ca('0x3b')&&_0x3303ee!=''){break;}if(_0x4ab935==_0x41ca('0x3b')&&_0x3303ee==''){for(var _0x51bc31=_0xcb0fd6;_0x51bc31<_0x38c290[_0x41ca('0x1b')];_0x51bc31++){var _0x1e93b9=_0x38c290[_0x51bc31];if(_0x1e93b9[0x0]<_0x31999a[_0x41ca('0x3c')]&&_0x31999a[_0x41ca('0x3c')]!=_0x41ca('0x3a')){break;}if(_0x4ea240(_0x5bc797,_0x1e93b9)==!![]){break;}}}}}function CounterMatch(_0x5074b0){function _0x2a627b(_0x355340,_0x11c767){var _0x2821ae=_0x11c767[0xd];var _0x4fbc86=_0x11c767[0xe];var _0x1e54a1=_0x355340[0x2];var _0x395289=_0x11c767[0x2];var _0x31a763=_0x11c767[0x1];var _0x2634db=_0x355340[0x6];var _0xb8b94c=_0x11c767[0x6];var _0x51200a=_0x355340[0x9];var _0x1b799d=_0x11c767[0x9];var _0x1cc330=_0x355340[0xc];var _0x37da90=_0x11c767[0xc];var _0x109dc9=_0x11c767[0x0];var _0x2bba9a=_0x355340[0x0];if(_0x2821ae==''||_0x2821ae=='~'){if(_0x31a763=='Buy'&&_0x395289==_0x1e54a1&&_0xb8b94c>_0x2634db){if(_0x4fbc86<=0x0&&_0x2821ae=='~'){_0x37ec50='';return![];}if(_0x4fbc86==''){_0x4fbc86=_0xb8b94c;}if(_0x4fbc86>=_0x2634db){_0x4fbc86=_0x4fbc86-_0x2634db;_0x5c9799=[];var _0x3432a8=_0x2634db/_0xb8b94c;var _0x56c113=((_0x51200a-_0x1cc330)/_0x2634db-(_0x1b799d+_0x37da90)/_0xb8b94c)*_0x2634db;var _0x3f8197=((_0x51200a-_0x1cc330)/_0x2634db-(_0x1b799d+_0x37da90)/_0xb8b94c)/((_0x1b799d+_0x37da90)/_0xb8b94c);if(_0x5074b0[_0x41ca('0x36')]=='ON'){if(_0x56c113<0x0){_0x56c113='';_0x3f8197='';}}_0x5c9799[_0x41ca('0x5')](['-','',_0x109dc9,_0x56c113,_0x3f8197,'']);range=_0x59e369[_0x41ca('0xb')](0x6+_0x2b6de1,0x10,0x1,0x6);range[_0x41ca('0x37')](_0x5c9799);_0x5c9799=[];var _0x37ec50=_0x2634db/_0xb8b94c;if(_0x4fbc86<=0x0){_0x37ec50='';}_0x5c9799['push'](['~',_0x4fbc86,'','','',_0x37ec50]);_0x11c767[0xe]=_0x4fbc86;_0x2821ae='~';_0x11c767[0xd]='~';range=_0x59e369[_0x41ca('0xb')](0x6+_0x599951,0x10,0x1,0x6);range['setValues'](_0x5c9799);return!![];}}}}DebugLog(_0x41ca('0x3d'),'');var _0x59e369=SpreadsheetApp[_0x41ca('0x9')]()[_0x41ca('0xa')](ORDERHISTORYTAB);var _0xf0a5a8=_0x59e369['getRange'](SHEETROW,SHEETCOL,_0x59e369[_0x41ca('0xc')](),0x10)[_0x41ca('0xd')]();var _0x5c9799=[];for(var _0x2b6de1=0x0;_0x2b6de1<_0xf0a5a8['length'];_0x2b6de1++){var _0x5af3a4=_0xf0a5a8[_0x2b6de1];if(_0x5af3a4[0x0]<_0x5074b0[_0x41ca('0x39')]&&_0x5074b0[_0x41ca('0x39')]!='OFF'){break;}var _0x24793d=_0x5af3a4[0x1]['trim']();var _0x4779dd=_0x5af3a4[0xd];if(_0x24793d=='Sell'&&_0x4779dd==''){for(var _0x599951=_0xf0a5a8[_0x41ca('0x1b')]-0x1;_0x599951>_0x2b6de1;_0x599951--){var _0x156542=_0xf0a5a8[_0x599951];Logger[_0x41ca('0x30')](_0x156542[0x0]+'\x20'+_0x5074b0[_0x41ca('0x3c')]);if(_0x156542[0x0]>_0x5074b0[_0x41ca('0x3c')]&&_0x5074b0['matchrangebuyorders']!='OFF'){if(_0x2a627b(_0x5af3a4,_0x156542)==!![]){break;}}}}}}function MarkOrphanedOrder(_0x2b269b){DebugLog('MarkOrphanedOrder','');var _0x2ea302=_0x2b269b[_0x41ca('0x11')];var _0x98cd8e=CreateBalances(_0x2b269b);if(_0x98cd8e==null){return null;}var _0x259525=SpreadsheetApp[_0x41ca('0x9')]()[_0x41ca('0xa')](ORDERHISTORYTAB);var _0x5cab68=_0x259525[_0x41ca('0xb')](SHEETROW,SHEETCOL,_0x259525[_0x41ca('0xc')](),0x10)[_0x41ca('0xd')]();if(_0x5cab68==null){return null;}for(var _0x4f1d8b=0x0;_0x4f1d8b<_0x5cab68[_0x41ca('0x1b')];_0x4f1d8b++){var _0x556607='NO';var _0x54927c=_0x5cab68[_0x4f1d8b][0x1];var _0x539512=_0x5cab68[_0x4f1d8b][0xd];if(_0x54927c==_0x41ca('0x35')&&_0x539512==''){for(var _0x2912ff=0x0;_0x2912ff<_0x98cd8e['length'];_0x2912ff++){var _0x133e40=_0x98cd8e[_0x2912ff][0x1];var _0x427496=_0x5cab68[_0x4f1d8b][0x2];var _0x36abe1=_0x98cd8e[_0x2912ff][0x2];var _0x5ce5dc=_0x5cab68[_0x4f1d8b][0x6];if(_0x133e40==_0x427496&&_0x5ce5dc*0x186a0<=_0x36abe1*0x186a0){var _0x556607=_0x41ca('0x3e');}}if(_0x556607=='NO'){range=_0x259525[_0x41ca('0xb')](0x6+_0x4f1d8b,0x10,0x1,0x1);range[_0x41ca('0x3f')]('X');_0x556607='';}}}CalcUnmatchedOrders(_0x2b269b);}function CalcUnmatchedOrders(_0x9873c8){DebugLog('CalcUnmatchedOrders','');var _0x3d06ac=SpreadsheetApp['getActiveSpreadsheet']();var _0x5e871f=_0x3d06ac[_0x41ca('0xa')](_0x41ca('0x40'));var _0xd6c063=_0x5e871f['getRange'](SHEETROW,0x3,_0x5e871f[_0x41ca('0xc')](),0xf)[_0x41ca('0xd')]();var _0x20815c=_0x5e871f['getRange'](SHEETROW,0x12,_0x5e871f[_0x41ca('0xc')](),0x9);_0x20815c[_0x41ca('0x41')]();var _0x3c7f14=[];var _0x521600=0x0;var _0x98d00a=0x0;var _0x109197=0x0;var _0x24e6ab=0x0;var _0x164f81=0x0;var _0x10f330=0x0;var _0x8cdd65='';var _0xb9c8cd=0x1;for(var _0x442cb8=0x0;_0x442cb8<_0xd6c063[_0x41ca('0x1b')];_0x442cb8++){if(_0xd6c063[_0x442cb8][0x0]==''){break;}if(_0xd6c063[_0x442cb8][0xd]=='~'){_0xb9c8cd=_0xd6c063[_0x442cb8][0xe]/_0xd6c063[_0x442cb8][0x6];}_0x8cdd65=UnNormalizeMarketCode(_0xd6c063[_0x442cb8][0x4]+_0xd6c063[_0x442cb8][0x2]);if(_0x8cdd65==null||_0x8cdd65==''){_0x8cdd65=UnNormalizeMarketCode(_0xd6c063[_0x442cb8][0x2]+_0xd6c063[_0x442cb8][0x4]);}_0x521600=Ticker(EXCHANGE,_0x8cdd65,_0x41ca('0x42'));if(_0x521600*0x186a0==0x0){_0x521600=Ticker(EXCHANGE,_0xd6c063[_0x442cb8][0x2]+_0xd6c063[_0x442cb8][0x4],'bid');}_0x164f81=_0xd6c063[_0x442cb8][0xc]/_0xd6c063[_0x442cb8][0x9];_0x98d00a=ToFiat(_0xd6c063[_0x442cb8][0x4],_0x521600*_0xd6c063[_0x442cb8][0x6]*_0xb9c8cd);_0x10f330=_0x98d00a*_0x164f81*_0xb9c8cd;_0x24e6ab=(_0xd6c063[_0x442cb8][0x9]+_0xd6c063[_0x442cb8][0xc])*_0xb9c8cd;_0x109197=_0x98d00a-_0x10f330-_0x24e6ab;_0x3c7f14[_0x41ca('0x5')]([_0x24e6ab,_0x521600,_0x98d00a,_0x10f330,_0x98d00a-_0x10f330,_0x109197,(_0x98d00a-_0x10f330-_0x24e6ab)/_0x24e6ab,moment(_0xd6c063[_0x442cb8][0x0],_0x41ca('0x43'))[_0x41ca('0x44')](),(_0x521600-_0xd6c063[_0x442cb8][0x7])/_0xd6c063[_0x442cb8][0x7]]);}if(_0x442cb8>0x0){var _0x20815c=_0x5e871f[_0x41ca('0xb')](SHEETROW,0x12,_0x442cb8,0x9);_0x20815c[_0x41ca('0x37')](_0x3c7f14);}}function CreateDeposits(_0x4d2a16){return eval(_0x4d2a16[_0x41ca('0x11')]+_0x41ca('0x45')+_0x41ca('0x15'));}function CreateWithdrawals(_0x5227db){return eval(_0x5227db['exchange']+'_Getwithdrawhistory'+_0x41ca('0x15'));}function TriggerPofile(){VERBOSE='ON';DEBUG=_0x41ca('0x3a');if(OrderMatchCounter=='Periodically'){OrderMatchCounter='ON';}if(UpdMarkets=='Periodically'){UpdMarkets='ON';}if(UpdDeposits==_0x41ca('0x46')){UpdDeposits='ON';}if(UpdWithdrawals=='Periodically'){UpdWithdrawals='ON';}if(CalcUnmatched=='Periodically'){CalcUnmatched='ON';}}function FixAPIfields(){sheet[_0x41ca('0xb')](_0x41ca('0x47'))[_0x41ca('0x48')]();sheet[_0x41ca('0xb')](_0x41ca('0x47'))[_0x41ca('0x3f')](HashExkey(EXKEY,_0x41ca('0x49')));sheet[_0x41ca('0xb')](_0x41ca('0x4a'))[_0x41ca('0x48')]();sheet[_0x41ca('0xb')](_0x41ca('0x4a'))[_0x41ca('0x3f')](HashExkey(EXSECRET,_0x41ca('0x49')));var _0x640a1f=sheet[_0x41ca('0xb')](_0x41ca('0x4b'));_0x640a1f[_0x41ca('0x4c')](!![],!![],!![],!![],!![],!![],'#cccccc',SpreadsheetApp[_0x41ca('0x4d')][_0x41ca('0x4e')]);_0x640a1f[_0x41ca('0x4f')](_0x41ca('0x50'));_0x640a1f[_0x41ca('0x51')](_0x41ca('0x52'));_0x640a1f[_0x41ca('0x53')]('Lato');_0x640a1f[_0x41ca('0x54')](0x9);_0x640a1f[_0x41ca('0x55')](_0x41ca('0x56'));_0x640a1f[_0x41ca('0x57')](_0x41ca('0x58'));_0x640a1f[_0x41ca('0x59')](_0x41ca('0x5a'));}function TriggersCreate(){Triggers('create');}function TriggersRemove(){Triggers(_0x41ca('0x5b'));}function CreateLicTrigger(){var _0x2352e8=SpreadsheetApp['getActive']();ScriptApp[_0x41ca('0x5c')](_0x41ca('0x5d'))['forSpreadsheet'](_0x2352e8)[_0x41ca('0x5e')]()[_0x41ca('0x5f')]();}function Triggers(_0x58e746){function _0x541fb8(_0x4691a7){var _0x125a84=ScriptApp[_0x41ca('0x60')]();for(var _0x464857=0x0;_0x464857<_0x125a84[_0x41ca('0x1b')];_0x464857++){if(_0x125a84[_0x464857][_0x41ca('0x61')]()==_0x4691a7){ScriptApp[_0x41ca('0x62')](_0x125a84[_0x464857]);}}}_0x541fb8(_0x41ca('0x63'));_0x541fb8('BotMon2');_0x541fb8(_0x41ca('0x64'));var _0x2c8110=SpreadsheetApp[_0x41ca('0x65')]();if(_0x58e746==_0x41ca('0x5b')){var _0xb47c0a=_0x2c8110[_0x41ca('0xb')](_0x41ca('0x66'))[_0x41ca('0x3f')](_0x41ca('0x3a'));FixAPIfields();}if(_0x58e746=='create'){var _0xb47c0a=_0x2c8110[_0x41ca('0xb')](_0x41ca('0x66'))[_0x41ca('0xd')]();var _0x4c2375=_0xb47c0a[0x0][0x0];var _0x141ea4=_0xb47c0a[0x1][0x0];var _0x3a9460=_0xb47c0a[0x2][0x0];ScriptApp[_0x41ca('0x5c')](_0x41ca('0x5d'))['forSpreadsheet'](_0x2c8110)[_0x41ca('0x5e')]()[_0x41ca('0x5f')]();if(_0x4c2375==_0x41ca('0x67')){ScriptApp['newTrigger'](_0x41ca('0x63'))[_0x41ca('0x68')](_0x2c8110)[_0x41ca('0x5e')]()['create']();}if(_0x141ea4==_0x41ca('0x69')){ScriptApp[_0x41ca('0x5c')](_0x41ca('0x6a'))[_0x41ca('0x6b')]()[_0x41ca('0x6c')](0x5)['create']();}if(_0x141ea4==_0x41ca('0x6d')){ScriptApp['newTrigger'](_0x41ca('0x6a'))[_0x41ca('0x6b')]()[_0x41ca('0x6c')](0xa)[_0x41ca('0x5f')]();}if(_0x141ea4==_0x41ca('0x6e')){ScriptApp[_0x41ca('0x5c')](_0x41ca('0x6a'))[_0x41ca('0x6b')]()[_0x41ca('0x6c')](0x1e)[_0x41ca('0x5f')]();}if(_0x141ea4==_0x41ca('0x6f')){ScriptApp[_0x41ca('0x5c')](_0x41ca('0x6a'))[_0x41ca('0x6b')]()[_0x41ca('0x70')](0x1)[_0x41ca('0x5f')]();}if(_0x3a9460==_0x41ca('0x71')){ScriptApp[_0x41ca('0x5c')](_0x41ca('0x64'))[_0x41ca('0x6b')]()[_0x41ca('0x72')](0x3)[_0x41ca('0x73')](0x1)[_0x41ca('0x5f')]();}if(_0x3a9460==_0x41ca('0x6f')){ScriptApp[_0x41ca('0x5c')](_0x41ca('0x64'))[_0x41ca('0x6b')]()[_0x41ca('0x70')](0x1)[_0x41ca('0x5f')]();}if(_0x3a9460==_0x41ca('0x74')){ScriptApp[_0x41ca('0x5c')](_0x41ca('0x64'))['timeBased']()[_0x41ca('0x70')](0x3)[_0x41ca('0x5f')]();}if(_0x3a9460==_0x41ca('0x75')){ScriptApp[_0x41ca('0x5c')](_0x41ca('0x64'))[_0x41ca('0x6b')]()[_0x41ca('0x70')](0x6)[_0x41ca('0x5f')]();}}if(VERBOSE=='NO'){Browser[_0x41ca('0x19')](_0x41ca('0x76')+_0x58e746+'d\x20\x5cn\x5cn');};FixAPIfields();CreateLicTrigger();}function ResetSheet(_0x9e0490){function _0x2192ea(_0x2e2b6e){var _0x153148=SpreadsheetApp[_0x41ca('0x9')]()['getSheetByName'](_0x2e2b6e);var _0x16089b=_0x153148[_0x41ca('0x77')]();if(_0x16089b>SHEETROW){_0x153148[_0x41ca('0x78')](SHEETROW+0x1,_0x16089b-SHEETROW);}_0x153148[_0x41ca('0xb')](SHEETROW,SHEETCOL,0x1,_0x153148['getLastColumn']())[_0x41ca('0x41')]();}if(LICCHK=='\x20'){Browser[_0x41ca('0x19')](_0x41ca('0x79'));return 0x0;}FixAPIfields();if(Browser[_0x41ca('0x19')](_0x41ca('0x7a'),Browser[_0x41ca('0x7b')][_0x41ca('0x7c')])=='NO'){return 0x1;}_0x2192ea(ORDERHISTORYTAB);_0x2192ea(_0x41ca('0x1'));_0x2192ea(_0x41ca('0x40'));_0x2192ea('Deposits');_0x2192ea(_0x41ca('0x7d'));_0x2192ea(_0x41ca('0x7e'));sheet[_0x41ca('0xb')](_0x41ca('0x7f'))[_0x41ca('0x3f')](_0x41ca('0x80'));sheet[_0x41ca('0xb')](_0x41ca('0x81'))[_0x41ca('0x41')]();sheet[_0x41ca('0xb')](_0x41ca('0x82'))[_0x41ca('0x3f')](_0x41ca('0x83'));sheet['getRange'](_0x41ca('0x84'))['setValue'](0x7d0);sheet[_0x41ca('0xb')](_0x41ca('0x85'))[_0x41ca('0x3f')]('ON');sheet[_0x41ca('0xb')]('CONFIG!D19')[_0x41ca('0x3f')](_0x41ca('0x67'));sheet[_0x41ca('0xb')](_0x41ca('0x86'))[_0x41ca('0x3f')]('Auto');sheet['getRange'](_0x41ca('0x87'))['clearContent']();sheet[_0x41ca('0xb')](_0x41ca('0x88'))[_0x41ca('0x3f')](_0x41ca('0x89'));sheet[_0x41ca('0xb')](_0x41ca('0x8a'))[_0x41ca('0x3f')]('ON');sheet[_0x41ca('0xb')](_0x41ca('0x8b'))[_0x41ca('0x3f')](_0x41ca('0x3a'));sheet['getRange'](_0x41ca('0x8c'))[_0x41ca('0x3f')](_0x41ca('0x3a'));sheet[_0x41ca('0xb')]('CONFIG!D36:D37')['setValue'](_0x41ca('0x3a'));sheet['getRange']('CONFIG!K8:K10')['setValue']('OFF');var _0x4b5b2e=sheet[_0x41ca('0xb')](ORDERHISTORYTAB+'!C6:C');_0x4b5b2e[_0x41ca('0x8d')]('yyyy-mm-dd\x20hh:mm:ss');var _0x4b5b2e=sheet[_0x41ca('0xb')](ORDERHISTORYTAB+_0x41ca('0x8e'));_0x4b5b2e[_0x41ca('0x8d')](_0x41ca('0x8f'));TriggersRemove();ResetLic();}function CSVImport(_0x4570d9){ImportSheet(_0x4570d9,_0x41ca('0x90'));DebugLog(_0x41ca('0x91'),_0x41ca('0x92'));}function BotMon0(){LicValidateTrigger();}function LicenseVerification(){var _0x1cc5fc=GetLicObject();switch(_0x1cc5fc[_0x41ca('0x93')][_0x41ca('0x94')]){case _0x41ca('0x95'):var _0x439e95=_0x1cc5fc[_0x41ca('0x93')][_0x41ca('0x96')][_0x41ca('0x97')]()+_0x41ca('0x98');break;case _0x41ca('0x99'):var _0x439e95=_0x41ca('0x9a')+_0x1cc5fc[_0x41ca('0x93')][_0x41ca('0x9b')];TriggersRemove();break;case _0x41ca('0x9c'):var _0x439e95=_0x1cc5fc['data']['lickey'];if(_0x1cc5fc[_0x41ca('0x9d')]!='')var _0x439e95=_0x1cc5fc[_0x41ca('0x9d')];break;}try{sheet[_0x41ca('0xb')](_0x41ca('0x9e'))[_0x41ca('0x3f')](_0x1cc5fc['data'][_0x41ca('0x94')][_0x41ca('0x9f')](0x0)[_0x41ca('0xa0')]()+_0x1cc5fc[_0x41ca('0x93')]['mode'][_0x41ca('0xa1')](0x1)+':');sheet['getRange']('CONFIG!$J$30')['setValue'](_0x439e95);if(LIC==='')sheet[_0x41ca('0xb')](_0x41ca('0xa2'))[_0x41ca('0x3f')]('=CONFIG!$J$30');}catch(_0x9b32af){DebugLog('Core',_0x41ca('0xa3'));}_0x1cc5fc[_0x41ca('0x9d')]=_0x439e95;return _0x1cc5fc;}